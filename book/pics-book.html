<!DOCTYPE html>
<meta charset="UTF-8">
<html>

<head>
  <title>book illustrations</title>

  <style>
    th {
      font-family: Arial;
      text-align: center;
    }

    /* styles for spacing collections of photos */
    div.photos {
      line-height: 2;
      letter-spacing: 1px;
    }

    .photos img {
      border: 1px solid gray;
    }

    /* styles for adding numbers to photos */
    span.n {
      position: relative;
      display: inline-block;
    }

    .n p {
      position: absolute;
      top: 0;
      left: 0;
      transform: translate(8%, -44%);
      background-color: rgba(255, 255, 255, 0.8);
      padding: 1px;
      text-align: center;
    }

  </style>

  <script src="../build/out.js"></script>
  <script type="text/javascript">
    // draw * on the edges that should be taped together
    const firstStar = { text: "*", which: 0, scale: 2 };
    const lastStar = { text: "*", which: -1, scale: 2 };
    const starCaptions = [firstStar, lastStar];
    // common colors for faces
    const labelAsTree = [0x7fbcff, 0x7fff82, 0xff827f, 0xc27fff, 0xfbff7f, 0x999999, 0xdddddd];

    // draw an unfolded strip on the given canvas
    // canvasId: string, numPats: number, flexes: string, rotation: number, start: number, end: number
    function drawStripPinch(canvasId, numPats, flexes, rotation, start, end, whereFlex, text, edge, angles, endStyle) {
      angles = angles ? angles : undefined;
      const script = [{ numPats, angles, flexes, labelAsTree: [] }];
      const fm = Flexagonator.createFromScript(script);
      const captions = whereFlex === undefined ? starCaptions : starCaptions.concat({ text, which: whereFlex, edge });
      Flexagonator.drawUnfolded(canvasId, fm, { rotation, content: { showLeafProps: true, endStyle }, captions, start, end });
    }

    // same as drawStripPinch except that it numbers the faces as they're created by 'flexes'
    function drawStripPinch2(canvasId, numPats, flexes, rotation, whereFlex, flexText, endStyle, angles) {
      angles = angles ? angles : [60, 60];
      const script = [{ numPats, angles, flexAndColor: { flexes: flexes } }];
      const fm = Flexagonator.createFromScript(script);
      const text = flexText ?? flexes;
      const captions = whereFlex === undefined ? starCaptions : starCaptions.concat({ text, which: whereFlex });
      Flexagonator.drawUnfolded(canvasId, fm, { rotation, content: { showLeafProps: true, endStyle }, captions });
    }

    // draw an unfolded strip for a generating sequence that's not just pinch flexes
    // canvasId: string, numPats: number, flexes: string, rotation: number, angles: [number],
    //   postFlexes: string (run after leaves are numbered), whereFlex: number (which pat to label with the generating sequence)
    //   edge: [optional] which edge to draw flex on
    function drawStripSequence(canvasId, numPats, flexes, rotation, angles, postFlexes, whereFlex, edge, text, endStyle) {
      const script = [{ numPats, flexes, angles, labelAsTree, reverseFlexes: flexes }, { flexes: postFlexes }];
      const fm = Flexagonator.createFromScript(script);
      text = text ? text : flexes;
      const captions = whereFlex === undefined ? starCaptions : starCaptions.concat({ text, which: whereFlex, edge });
      const options = { rotation, content: { showLeafProps: true, endStyle }, captions };
      Flexagonator.drawUnfolded(canvasId, fm, options);
    }

    // use folding order rather than tree order for odd-ordered flexagon
    function drawOddStripSequence(canvasId, numPats, flexes, rotation, postFlexes, whereFlex, text, leafProps, edge) {
      const script = [{ numPats, flexes, angles: [], reverseFlexes: flexes }, { flexes: postFlexes }];
      if (leafProps) script.push({ normalizeIds: true, leafProps });  // tack on leaf props if present
      const fm = Flexagonator.createFromScript(script);
      const captions = whereFlex === undefined ? starCaptions : starCaptions.concat({ text, which: whereFlex, edge });
      const content = leafProps ? { showLeafProps: true } : { showFoldingOrder: true };
      const options = { rotation, content, captions };
      Flexagonator.drawUnfolded(canvasId, fm, options);
    }

    // draw an unfolded strip on the given canvas
    // pass in a full script & full options for drawUnfolded
    function drawStripComplex(canvasId, script, drawOptions) {
      const fm = Flexagonator.createFromScript(script);
      Flexagonator.drawUnfolded(canvasId, fm, drawOptions);
    }

    // draw a folded flexagon, just showing the outline of the leaves
    function drawFlexagonSimple(canvasId, numPats, angles) {
      const script = angles ? [{ numPats: numPats, angles: angles }] : [{ numPats: numPats }];
      const fm = Flexagonator.createFromScript(script);
      Flexagonator.drawEntireFlexagon(canvasId, fm, { showIds: false, showCurrent: false, showNumbers: false });
    }

    // draw a folded flexagon, showing possible flexes
    function drawFlexagonComplex(canvasId, script) {
      const fm = Flexagonator.createFromScript(script);
      const regions = Flexagonator.drawEntireFlexagon(canvasId, fm, { showIds: false, showCurrent: false, showNumbers: false });
      Flexagonator.drawScriptButtons(canvasId, fm.flexagon, fm.getAngleInfo(), true, regions);
    }

    function drawFromName(canvasId, name, rotation) {
      const fm = Flexagonator.createFromScript([{ name }]);
      Flexagonator.drawUnfolded(canvasId, fm, { rotation, content: {} });
    }

    // special handling of the regular penta-<x>flexagon to make for a better numbering scheme
    function drawPenta(canvasId, numPats, rotation, extraCaptions) {
      const pentaPats = [0, [0, [0, [0, 0]]]];
      const pentaNums = [[2, 1], [2, 3], [3, 4], [4, 5], [5, 1]];
      const pats = Array(numPats / 2).fill(pentaPats).flatMap(p => p);
      const numbers = Array(numPats / 2).fill(pentaNums).flatMap(p => p);
      const leafProps = numbers.map(pair => {
        return { front: { label: pair[0].toString() }, back: { label: pair[1].toString() } };
      });

      const script = [{ pats, angles: [60, 60], leafProps }];
      const fm = Flexagonator.createFromScript(script);
      let captions = starCaptions.concat({ text: "5", which: 2, edge: 2 });
      if (extraCaptions) captions = captions.concat(extraCaptions);
      const options = { rotation, content: { showLeafProps: true }, captions };
      Flexagonator.drawUnfolded(canvasId, fm, options);
    }

    // draw the Tuckerman diagram for a flexagon with the given generating sequence,
    // optionally highlighting one flex sequence
    function drawTuckerman(canvasId, generator, highlight) {
      const fm = Flexagonator.createFromScript([{ flexes: generator }]);
      const traverse = Flexagonator.findTuckermanTraverse(fm.flexagon);
      Flexagonator.drawPinchGraph(canvasId, { traverse: traverse, flexes: highlight });
    }

    // draw a series of flexagons in different states based on a sequence,
    // expects several canvases (canvasId + "1", canvasId + "2", ...)
    // generator is the generating sequence for creating the flexagon,
    // sequence is an array of flexes to perform one at a time
    // [optional] amount to scale
    // [optional] amount to rotate
    function drawSequence(canvasId, numPats, generator, sequence, scale, rotate, showCurrent) {
      const script = [{ numPats }, { flexes: generator }, { labelAsTree }];
      const fm = Flexagonator.createFromScript(script);
      for (let i = 0; i < sequence.length; i++) {
        const id = canvasId + (i + 1).toString();
        fm.applyFlexes(sequence[i]);
        Flexagonator.drawEntireFlexagon(id, fm, { showIds: false, scale, rotate, showCurrent: false });
      }
    }

    // turn template numbering like [[2,1],[2,3],[3,4]] into leafProps containing labels & colors
    function pairsToProps(numbering, repeats) {
      const numbers = Array(repeats).fill(numbering).flatMap(p => p);
      const leafProps = numbers.map(pair => {
        return { front: { label: pair[0].toString(), color: labelAsTree[pair[0] - 1] }, back: { label: pair[1].toString(), color: labelAsTree[pair[1] - 1] } };
      });
      return leafProps;
    }
  </script>
</head>

<body>
  <h1>Book illustrations</h1>

  <ul>
    <li><a href="#intro">Introduction</a></li>
    <li><a href="#part1">Part One: Pinch Flex and Variations</a></li>
    <ul>
      <li><a href="#3faces">3 faces</a></li>
      <li><a href="#456faces">4, 5, 6 faces</a></li>
      <li><a href="#longer">longer templates</a></li>
      <li><a href="#tetra-octa">triangle tetra & octaflexagons</a></li>
      <li><a href="#different">different triangles</a></li>
      <li><a href="#pinch-variations">pinch variations</a></li>
      <li><a href="#book">book flex</a></li>
      <li><a href="#box">box flex</a></li>
    </ul>
    <li><a href="#part2">Part Two: Flexes</a></li>
    <ul>
      <li><a href="#tuck">tuck flex</a></li>
      <li><a href="#pyramid shuffle">pyramid shuffle</a></li>
      <li><a href="#flip">flip flex</a></li>
      <li><a href="#vflex">v flex</a></li>
      <li><a href="#silver tetra">silver tetra flex</a></li>
      <li><a href="#half-flexes">half flexes</a></li>
      <li><a href="#slot-flexes">slot flexes</a></li>
      <li><a href="#hexa-silver-dodeca">hexagonal silver dodeca</a></li>
    </ul>
    <li><a href="#part3">Part Three: Learning</a></li>
    <ul>
      <li><a href="#state-diagrams">state diagrams</a></li>
      <li><a href="#sequences">sequences</a></li>
      <li><a href="#pat-notation">pat notation</a></li>
      <li><a href="#atomic-flex-theory">atomic flex theory</a></li>
      <li><a href="#groups">groups</a></li>
    </ul>
    <li><a href="#part4">Part Four: Fun</a></li>
    <ul>
      <li><a href="#popups">popups</a></li>
    </ul>
  </ul>

  <hr />

  <!-- intro -->

  <h2 id="intro">Introduction</h2>

  <img src="../idyll/static/flexagon-variety.jpg" /><br/><br/>

  <!-- part 1 -->

  <hr />

  <h2 id="part1">Part One: Pinch Flex and Variations</h2>

  <!-- 3 faces-->
  <h3 id="3faces">3 faces</h3>

  <h4>tri-hexaflexagon</h4>
  <div class="photos">
    <span class="n"><p>1</p><img src="photos/pinch/pinch (2).jpg" width="150"/></span>
    <span class="n"><p>2</p><img src="photos/pinch/pinch (1).jpg" width="150"/></span>
    <span class="n"><p>3</p><img src="photos/pinch/pinch (3).jpg" width="150"/></span>
    <span class="n"><img src="photos/pinch/pinch (4).jpg" width="150"/></span>
    <span class="n"><p>4</p><img src="photos/pinch/pinch (5).jpg" width="150"/></span>
    <br/>
    <span class="n"><img src="photos/pinch/pinch (6).jpg" width="150"/></span>
    <span class="n"><p>5</p><img src="photos/pinch/pinch (7).jpg" width="150"/></span>
    <span class="n"><p>6</p><img src="photos/pinch/pinch (8).jpg" width="150"/></span>
    <span class="n"><p>7</p><img src="photos/pinch/pinch (10).jpg" width="150"/></span>
    <span class="n"><img src="photos/pinch/pinch (11).jpg" width="150"/></span>
  </div>
  <canvas id="tri-hexa" width="800" height="180"></canvas>
  <script type="text/javascript">
    drawStripPinch("tri-hexa", 6, "P*", 120, undefined, undefined, 0, "3", 2);
  </script>

  <!-- 4, 5, & 6 faces-->
  <h3 id="456faces">4, 5, & 6 faces</h3>

  <h4>tetra-hexaflexagon strip</h4>
  <canvas id="tetra-hexa" width="1200" height="220"></canvas>
  <script type="text/javascript">
    drawStripPinch("tetra-hexa", 6, "P*P+", 30, undefined, undefined, 3, "4", 1);
  </script>

  <h4>penta-hexaflexagon strip</h4>
  <canvas id="penta-hexa" width="1000" height="475"></canvas>
  <script type="text/javascript">
    drawPenta("penta-hexa", 6, 60);
  </script>

  <h4>hexa-hexaflexagon strips</h4>
  <canvas id="hexa-hexa1" width="1200" height="120"></canvas>
  <canvas id="hexa-hexa2" width="700" height="610"></canvas>
  <canvas id="hexa-hexa3" width="700" height="700"></canvas>
  <script type="text/javascript">
    drawStripPinch2("hexa-hexa1", 6, "P* P+ >P>P P+ ^P P+ ^P^", 120, 1, "6a");
    drawStripPinch2("hexa-hexa2", 6, "P* P+ >P>P P+ PP+ ^P", 0, 1, "6b", "solid");
    drawStripPinch2("hexa-hexa3", 6, "P* P+ >P>P P+ >PPP+ ^PP", 0, -2, "6c", "solid");
  </script>

  <!-- longer templates -->
  <h3 id="longer">longer templates</h3>

  <h4>dodeca-hexaflexagon strip</h4>
  <canvas id="dodeca-hexa" width="1200" height="180"></canvas>
  <script type="text/javascript">
    var A = "P'*>(P*)2";
    var B = "P'*>(P*)4";
    var sequence = A + B + A + B + A;
    drawStripPinch("dodeca-hexa", 6, sequence, 120, 0, 11, 0, "12", 2);
  </script>

  <h4>icositetra-hexaflexagon strip</h4>
  <canvas id="icositetra-hexa" width="1200" height="100"></canvas>
  <script type="text/javascript">
    var A = "P'*>(P*)2";
    var B = "P'*>(P*)4";
    var C = "P'*>(P*)6";
    var sequence = A + B + A + C + A + B + A + C + A + B + A;
    drawStripPinch("icositetra-hexa", 6, sequence, 120, 0, 23, 0, "24", 2);
  </script>

  <!-- triangle tetra & octa -->
  <h3 id="tetra-octa">triangle tetra & octa</h3>

  <h4>regular tri-tetraflexagon strip</h4>
  <canvas id="tri-tetra" width="880" height="220"></canvas>
  <script type="text/javascript">
    var script = [{ numPats: 4, flexes: "P*", angles: [60, 60], labelAsTree: [] }];
    var captions = starCaptions.concat({ text: "3", which: 0, edge: 2 }, { text: "+", which: 3, edge: 1 }, { text: "+", which: 4, edge: 1 });
    var drawOptions = { rotation: 120, content: { showLeafProps: true }, captions };
    drawStripComplex("tri-tetra", script, drawOptions);
  </script>
  <br/><br/>
  <div class="photos">
    <span class="n"><p>1</p><img src="photos/tetra-octa/tri-tetra (1).jpg" width="150"/></span>
    <span class="n"><img src="photos/tetra-octa/tri-tetra (2).jpg" width="150"/></span>
    <span class="n"><p>2</p><img src="photos/tetra-octa/tri-tetra (3).jpg" height="150"/></span>
    <span class="n"><img src="photos/tetra-octa/tri-tetra (4).jpg" height="150"/></span>
    <span class="n"><p>3</p><img src="photos/tetra-octa/tri-tetra (5).jpg" height="150"/></span>
    <span class="n"><p>4</p><img src="photos/tetra-octa/tri-tetra (6).jpg" width="150"/></span>
  </div>

  <h4>regular penta-tetraflexagon strip</h4>
  <canvas id="penta-tetra" width="770" height="500"></canvas>
  <script type="text/javascript">
    drawPenta("penta-tetra", 4, 60, [{ text: "+", which: 0, edge: 2 }, { text: "+", which: -1, edge: 0 }]);
  </script>
  <br/><br/>
  <div class="photos">
    <span class="n"><p>1</p><img src="photos/tetra-octa/penta-tetra (1).jpg" width="150"/></span>
    <span class="n"><p>2</p><img src="photos/tetra-octa/penta-tetra (2).jpg" width="150"/></span>
    <span class="n"><img src="photos/tetra-octa/penta-tetra (3).jpg" width="150"/></span>
    <span class="n"><p>3</p><img src="photos/tetra-octa/penta-tetra (4).jpg" width="150"/></span>
    <span class="n"><p>4</p><img src="photos/tetra-octa/penta-tetra (5).jpg" width="150"/></span>
    <br/>
    <span class="n"><img src="photos/tetra-octa/penta-tetra (6).jpg" width="150"/></span>
    <span class="n"><p>5</p><img src="photos/tetra-octa/penta-tetra (7).jpg" width="150"/></span>
    <span class="n"><img src="photos/tetra-octa/penta-tetra (8).jpg" width="150"/></span>
    <span class="n"><p>6</p><img src="photos/tetra-octa/penta-tetra (9).jpg" width="150"/></span>
    <span class="n"><img src="photos/tetra-octa/penta-tetra (10).jpg" width="150"/></span>
  </div>

  <h4>regular tri-octaflexagon strip</h4>
  <canvas id="tri-octa" width="1200" height="220"></canvas>
  <script type="text/javascript">
    var script = [{ numPats: 8, flexes: "P*", angles: [60, 60], labelAsTree: [] }];
    var captions = starCaptions.concat({ text: "3", which: 0, edge: 2 });
    var drawOptions = { rotation: 120, content: { showLeafProps: true }, captions };
    drawStripComplex("tri-octa", script, drawOptions);
  </script>
  <div class="photos">
    <span class="n"><p>1</p><img src="photos/tetra-octa/tri-octa (1).jpg" width="150"/></span>
    <span class="n"><p>2</p><img src="photos/tetra-octa/tri-octa (2).jpg" width="150"/></span>
    <span class="n"><p>2</p><img src="photos/tetra-octa/tri-octa (3).jpg" width="150"/></span>
    <span class="n"><p>3</p><img src="photos/tetra-octa/tri-octa (4).jpg" width="150"/></span>
  </div>

  <h4>regular penta-octaflexagon strip</h4>
  <canvas id="penta-octa" width="1200" height="448"></canvas>
  <script type="text/javascript">
    drawPenta("penta-octa", 8, 60, [{ text: "+", which: 2, edge: 0 }, { text: "+", which: 5, edge: 0 }]);
  </script>
  <div class="photos">
    <span class="n"><p>1</p><img src="photos/tetra-octa/penta-octa (1).jpg" width="150"/></span>
    <span class="n"><p>2</p><img src="photos/tetra-octa/penta-octa (2).jpg" width="150"/></span>
    <span class="n"><p>3</p><img src="photos/tetra-octa/penta-octa (3).jpg" width="150"/></span>
    <span class="n"><p>4</p><img src="photos/tetra-octa/penta-octa (4).jpg" width="150"/></span>
    <br/>
    <span class="n"><img src="photos/tetra-octa/penta-octa (5).jpg" width="150"/></span>
    <span class="n"><p>5</p><img src="photos/tetra-octa/penta-octa (6).jpg" width="150"/></span>
    <span class="n"><p>6</p><img src="photos/tetra-octa/penta-octa (7).jpg" width="150"/></span>
  </div>

  <!-- different triangles -->
  <h3 id="different">different triangles</h3>

  <canvas id="diff-bronze-tri-hexa" width="1000" height="500"></canvas><br/><br/>
  <canvas id="diff-bronze-hexa-hexa" width="1200" height="322"></canvas><br/><br/>
  <canvas id="diff-silver-tetra-octa" width="750" height="750"></canvas><br/><br/>
  <canvas id="diff-silver-tetra-tetra" width="1000" height="500"></canvas>
  <script type="text/javascript">
    drawStripSequence("diff-bronze-tri-hexa", 6, "P+", 90, [60, 90], ">", -3);
    drawStripPinch2("diff-bronze-hexa-hexa", 6, "P* P+ >P>P P+ ^P P+ ^P^", 90, 1, "6a", undefined, [90, 30]);
    drawStripPinch("diff-silver-tetra-octa", 8, "P*P+", 45, undefined, undefined, 3, "4", 1, [45, 90], "solid");
    drawStripSequence("diff-silver-tetra-tetra", 4, "P* ^> P* ^> P* P+", 45, [90, 45], undefined, -1, 0, "6", "solid");
  </script>

  <!-- pinch flex variations -->
  <h3 id="pinch-variations">pinch flex variations</h3>

  <h4>P444</h4>
  <canvas id="P444" width="1200" height="400"></canvas>
  <script type="text/javascript">
    drawStripPinch("P444", 12, "P444*", undefined, undefined, undefined, 0, "P444", 2);
  </script>

  <p>
    you can do a P444h (half of a P444) on this one & it'll still be flat,
    though the leaves no longer meet in the middle
  </p>
  <canvas id="P444-half" width="1200" height="250"></canvas>
  <script type="text/javascript">
    var script = [{ "pats": [1, 2, 3, [0, 0], 5, 6, 7, [0, 0], 9, 10, 11, [0, 0]] }, { "angles": [30, 60, 90] }];
    var captions = starCaptions.concat({ text: "P444h", which: 1, edge: 2 });
    drawStripComplex("P444-half", script, { rotation: 60, content: { showFoldingOrder: true }, captions });
  </script>

  <h4>P333</h4>
  <canvas id="P333" width="1200" height="400"></canvas>
  <script type="text/javascript">
    drawStripPinch("P333", 9, "P333*>>", undefined, undefined, undefined, -2, "P333", 0);
  </script>
  <br/>

  <div class="photos">
    <img src="../idyll/static/P4-4-4/1.jpg" width="150"/>
    <img src="../idyll/static/P4-4-4/2.jpg" width="150"/>
    <img src="../idyll/static/P4-4-4/3.jpg" width="150"/>
    <img src="../idyll/static/P4-4-4/4.jpg" width="150"/>
    <br/>
    <img src="../idyll/static/P4-4-4/5.jpg" width="150"/>
    <img src="../idyll/static/P4-4-4/6.jpg" width="150"/>
    <img src="../idyll/static/P4-4-4/7.jpg" width="150"/>
    <img src="../idyll/static/P4-4-4/8.jpg" width="150"/>
    <br/>
    <img src="../idyll/static/P4-4-4/9.jpg" width="150"/>
    <img src="../idyll/static/P4-4-4/10.jpg" width="150"/>
    <img src="../idyll/static/P4-4-4/11.jpg" width="150"/>
    <img src="../idyll/static/P4-4-4/12.jpg" width="150"/>
    <img src="../idyll/static/P4-4-4/13.jpg" width="150"/>
  </div>

  <h4>P334</h4>
  <canvas id="P334" width="1200" height="400"></canvas>
  <script type="text/javascript">
    drawStripPinch("P334", 10, "P334*", undefined, undefined, undefined, 0, "P334", 2);
  </script>
  <br/>

  <div class="photos">
    <img src="../idyll/static/P3-3-4/1.jpg" width="150"/>
    <img src="../idyll/static/P3-3-4/2.jpg" width="150"/>
    <img src="../idyll/static/P3-3-4/3.jpg" width="150"/>
    <img src="../idyll/static/P3-3-4/4.jpg" width="150"/>
    <br/>
    <img src="../idyll/static/P3-3-4/5.jpg" width="150"/>
    <img src="../idyll/static/P3-3-4/6.jpg" width="150"/>
    <img src="../idyll/static/P3-3-4/7.jpg" width="150"/>
    <img src="../idyll/static/P3-3-4/8.jpg" width="150"/>
    <br/>
    <img src="../idyll/static/P3-3-4/9.jpg" width="150"/>
    <img src="../idyll/static/P3-3-4/10.jpg" width="150"/>
    <img src="../idyll/static/P3-3-4/11.jpg" width="150"/>
    <img src="../idyll/static/P3-3-4/12.jpg" width="150"/>
    <img src="../idyll/static/P3-3-4/13.jpg" width="150"/>
  </div>

  <h4>P223</h4>
  <canvas id="P223" width="1200" height="360"></canvas>
  <script type="text/javascript">
    var captions = starCaptions.concat({ text: "P223", which: 3, edge: 1 });
    drawStripComplex("P223",
      [{ pats: [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], angles: [] }],
      { rotation: 25.714, captions });
  </script>

  <hr />

  <h3 id="book">book flex</h3>

  <img src="images/square-book.jpg" /><br/><br/>
  <img src="images/square-P.png" width=900 /><br/><br/>
  <img src="images/square-PP.png" width=900 /><br/><br/>
  <img src="images/square-PPP.png" width=900 /><br/><br/>
  <img src="images/square-PPPP.png" width=900 /><br/><br/>
  <img src="images/square-PRP.png" width=900 /><br/><br/>
  <img src="images/square-PlRPr.png" width=900 /><br/><br/>
  <img src="images/square-PURx2.png" width=900 /><br/><br/>
  <img src="images/square-PURx3.png" width=900 /><br/><br/>
  <img src="images/square-PURx4.png" width=800 /><br/><br/>
  <img src="images/pentagon-P.png" width=800 /><br/><br/>
  <img src="images/pentagon-P5-1.png" width=800 /><br/><br/>
  <img src="images/pentagon-P5-2.png" width=800 /><br/><br/>
  <img src="images/pentagon-PP.png" width=800 /><br/><br/>

  <h3 id="box">box flex</h3>

  <img src="images/square-box-top.jpg" /><br/><br/>
  <img src="images/square-Bt.png" width=900 /><br/><br/>
  <img src="images/square-box-bottom.jpg" /><br/><br/>
  <img src="images/square-Bb.png" width=900 /><br/><br/>
  <img src="images/square8.png" width=900 /><br/><br/>
  <img src="images/square10.png" width=800 /><br/><br/>
  <img src="images/pentagon-B1.png" width=800 /><br/><br/>
  <img src="images/pentagon-B2.png" width=800 /><br/><br/>

  <!-- Part 2-->

  <h2 id="part2">Part Two: Flexes</h2>

  <h3 id="tuck">tuck flex</h3>

  <div class="photos">
    <img src="../idyll/static/T/T1.jpg" width="150"/>
    <img src="../idyll/static/T/T2.jpg" width="150"/>
    <img src="../idyll/static/T/T3.jpg" width="150"/>
    <img src="../idyll/static/T/T4.jpg" width="150"/>
    <br/>
    <img src="../idyll/static/T/T5.jpg" width="150"/>
    <img src="../idyll/static/T/T6.jpg" width="150"/>
    <img src="../idyll/static/T/T7.jpg" width="150"/>
    <img src="../idyll/static/T/T8.jpg" width="150"/>
    <br/>
    <img src="../idyll/static/T/T9.jpg" width="150"/>
    <img src="../idyll/static/T/T10.jpg" width="150"/>
    <img src="../idyll/static/T/T11.jpg" width="150"/>
    <img src="../idyll/static/T/T12.jpg" width="150"/>
    <br/>
    <img src="../idyll/static/T/T13.jpg" width="150"/>
    <img src="../idyll/static/T/T14.jpg" width="150"/>
  </div>
  <br/><br/>
  <canvas id="T-6-bronze-minimal" width="750" height="500"></canvas><br/><br/>
  <canvas id="T-6-minimal" width="900" height="400"></canvas><br/><br/>
  <canvas id="T-8" width="500" height="500"></canvas>
  <script type="text/javascript">
    drawStripSequence("T-6-bronze-minimal", 6, "T*", 120, [60, 30], "^>>", -2);
    drawStripSequence("T-6-minimal", 6, "T*", -60, undefined, "^>>", -2);
    drawStripSequence("T-8", 8, "(T2+>>)4", 45, [45, 45], "", 4);
  </script>

  <h3 id="pyramid shuffle">pyramid shuffle</h3>

  <div class="photos">
    <img src="../idyll/static/Sh/Sh1.jpg" width="150"/>
    <img src="../idyll/static/Sh/Sh2.jpg" width="150"/>
    <img src="../idyll/static/Sh/Sh3.jpg" width="150"/>
    <img src="../idyll/static/Sh/Sh4.jpg" width="150"/>
    <br/>
    <img src="../idyll/static/Sh/Sh5.jpg" width="150"/>
    <img src="../idyll/static/Sh/Sh6.jpg" width="150"/>
    <img src="../idyll/static/Sh/Sh7.jpg" width="150"/>
    <img src="../idyll/static/Sh/Sh8.jpg" width="150"/>
    <br/>
    <img src="../idyll/static/Sh/Sh9.jpg" width="150"/>
    <img src="../idyll/static/Sh/Sh10.jpg" width="150"/>
    <img src="../idyll/static/Sh/Sh11.jpg" width="150"/>
    <img src="../idyll/static/Sh/Sh12.jpg" width="150"/>
    <br/>
    <img src="../idyll/static/Sh/Sh13.jpg" width="150"/>
    <img src="../idyll/static/Sh/Sh14.jpg" width="150"/>
    <img src="../idyll/static/Sh/Sh15.jpg" width="150"/>
    <img src="../idyll/static/Sh/Sh16.jpg" width="150"/>
    <img src="../idyll/static/Sh/Sh17.jpg" width="150"/>
  </div>
  <br/><br/>
  <canvas id="S-6-minimal" width="800" height="500"></canvas><br/><br/>
  <canvas id="S-8-silver-minimal" width="1000" height="400"></canvas><br/><br/>
  <canvas id="S-5-minimal" width="800" height="500"></canvas><br/><br/>
  <canvas id="S-6-S3" width="1000" height="500"></canvas>
  <script type="text/javascript">
    drawStripSequence("S-6-minimal", 6, "S*", -120, undefined, ">>", -2, 1);
    drawStripSequence("S-8-silver-minimal", 8, "S*", 0, [45, 90], ">>", -2, 1);
    drawOddStripSequence("S-5-minimal", 5, "S*", -72, ">>", -2, "S*", undefined, 1);
    drawStripSequence("S-6-S3", 6, "(S*<<)3", -60, undefined, undefined, 2, 2);
  </script>

  <h3 id="flip">flip flex</h3>

  <div class="photos">
    <span class="n"><img src="photos/flip/flip (1).jpg" width="150"/></span>
    <span class="n"><p>1</p><img src="photos/flip/flip (2).jpg" width="150"/></span>
    <span class="n"><img src="photos/flip/flip (3).jpg" width="150"/></span>
    <span class="n"><p>2</p><img src="photos/flip/flip (4).jpg" width="150"/></span>
    <span class="n"><img src="photos/flip/flip (5).jpg" width="150"/></span>
    <br/>
    <span class="n"><p>3</p><img src="photos/flip/flip (6).jpg" width="150"/></span>
    <span class="n"><img src="photos/flip/flip (7).jpg" width="150"/></span>
    <span class="n"><p>4</p><img src="photos/flip/flip (8).jpg" width="150"/></span>
    <span class="n"><p>5</p><img src="photos/flip/flip (9).jpg" width="150"/></span>
    <span class="n"><p>6</p><img src="photos/flip/flip (10).jpg" width="150"/></span>
  </div>
  <br/><br/>
  <canvas id="F-8-minimal" width="900" height="400"></canvas><br/><br/>
  <canvas id="F-6-minimal" width="900" height="500"></canvas><br/><br/>
  <canvas id="F-10-F5" width="1100" height="500"></canvas><br/><br/>
  <canvas id="F-7-cycle" width="1000" height="600"></canvas>
  <script type="text/javascript">
    drawStripSequence("F-8-minimal", 8, "F*", 0, [45, 90], ">>", -2, 1);
    drawStripSequence("F-6-minimal", 6, "F*", 90, [60, 90], ">>", -2, 1);
    drawStripSequence("F-10-F5", 10, "(F+>>)5", 0, [36, 90], undefined, 2, 1);
    const leafProps7 = pairsToProps([[1, 2], [3, 4], [2, 4], [1, 5], [3, 5], [4, 3], [4, 2], [5, 1], [5, 3], [3, 4],
    [2, 4], [1, 5], [3, 5], [4, 3], [4, 2], [5, 1], [5, 3], [1, 2], [3, 2], [3, 1]], 1);
    drawOddStripSequence("F-7-cycle", 7, "(F*<)5", undefined, "^", -3, "(F<)5", leafProps7, 1);
  </script>

  <h3 id="vflex">v flex</h3>

  <div class="photos">
    <img src="../idyll/static/V/V1.jpg" width="150"/>
    <img src="../idyll/static/V/V2.jpg" width="150"/>
    <img src="../idyll/static/V/V3.jpg" width="150"/>
    <img src="../idyll/static/V/V4.jpg" width="150"/>
    <br/>
    <img src="../idyll/static/V/V5.jpg" width="150"/>
    <img src="../idyll/static/V/V6.jpg" width="150"/>
    <img src="../idyll/static/V/V7.jpg" width="150"/>
    <img src="../idyll/static/V/V8.jpg" width="150"/>
    <br/>
    <img src="../idyll/static/V/V9.jpg" width="150"/>
    <img src="../idyll/static/V/V10.jpg" width="150"/>
    <img src="../idyll/static/V/V11.jpg" width="150"/>
    <img src="../idyll/static/V/V12.jpg" width="150"/>
    <img src="../idyll/static/V/V13.jpg" width="150"/>
  </div>
  <br/><br/>
  <canvas id="V-minimal" width="900" height="450"></canvas>
  <canvas id="V-cycle6" width="1000" height="140"></canvas>
  <canvas id="V-cycle15" width="1000" height="110"></canvas>
  <script type="text/javascript">
    drawStripSequence("V-minimal", 6, "V*", 60, undefined, undefined, 0, 2);
    drawStripSequence("V-cycle6", 6, "(V*>)6", -60, undefined, undefined, -1, 1);
    drawStripSequence("V-cycle15", 6, "(V*<)15", 60, undefined, undefined, -2, 2);
  </script>
  <h4>(V>)6 cycle</h4>
  <canvas id="sequences-v6-1" width="180" height="200"></canvas>
  <canvas id="sequences-v6-2" width="180" height="200"></canvas>
  <canvas id="sequences-v6-3" width="180" height="200"></canvas>
  <canvas id="sequences-v6-4" width="180" height="200"></canvas>
  <br/>
  <canvas id="sequences-v6-5" width="180" height="200"></canvas>
  <canvas id="sequences-v6-6" width="180" height="200"></canvas>
  <canvas id="sequences-v6-7" width="180" height="200"></canvas>
  <h4>(V&lt;)15 cycle</h4>
  <canvas id="sequences-v15-1" width="180" height="200"></canvas>
  <canvas id="sequences-v15-2" width="180" height="200"></canvas>
  <canvas id="sequences-v15-3" width="180" height="200"></canvas>
  <canvas id="sequences-v15-4" width="180" height="200"></canvas>
  <br/>
  <canvas id="sequences-v15-5" width="180" height="200"></canvas>
  <canvas id="sequences-v15-6" width="180" height="200"></canvas>
  <canvas id="sequences-v15-7" width="180" height="200"></canvas>
  <canvas id="sequences-v15-8" width="180" height="200"></canvas>
  <br/>
  <canvas id="sequences-v15-9" width="180" height="200"></canvas>
  <canvas id="sequences-v15-10" width="180" height="200"></canvas>
  <canvas id="sequences-v15-11" width="180" height="200"></canvas>
  <canvas id="sequences-v15-12" width="180" height="200"></canvas>
  <br/>
  <canvas id="sequences-v15-13" width="180" height="200"></canvas>
  <canvas id="sequences-v15-14" width="180" height="200"></canvas>
  <canvas id="sequences-v15-15" width="180" height="200"></canvas>
  <canvas id="sequences-v15-16" width="180" height="200"></canvas>
  <script type="text/javascript">
    drawSequence("sequences-v6-", 6, "(V*>)6", ["", "V>", "V>", "V>", "V>", "V>", "V>"], 1.1, -30);
    drawSequence("sequences-v15-", 6, "(V*<)15", ["", "V<", "V<", "V<", "V<", "V<", "V<", "V<", "V<", "V<", "V<", "V<", "V<", "V<", "V<", "V<"], 1.1, -30);
  </script>

  <h3 id="half-flexes">half flexes</h3>

  <p>silver octaflexagon: Hf, Hb, Hr, Hl, Hfs, Hbs</p>
  <canvas id="silverHalfFlexes" width="1000" height="500"></canvas><br/><br/>
  <script type="text/javascript">
    var silverHalfFlexes = [
      { numPats: 8, "angles": [45, 45], "addHalfFlexes": true },
      { flexes: "> Hf* Hb'+Hl'+Hr'+Hbs'+Hfs'+ Hf' Hb* Hf'+Hl'+Hr'+Hbs'+Hfs'+ Hb' Hl* Hf'+Hb'+Hr'+Hbs'+Hfs'+ Hl' Hr* Hf'+Hb'+Hl'+Hbs'+Hfs'+ Hr' Hbs* Hf'+Hb'+Hl'+Hr'+Hfs'+ Hbs' Hfs* Hf'+Hb'+Hl'+Hr'+Hbs'+ Hfs' >>>>" },
      { labelAsTree: [] }
    ];
    var fm = Flexagonator.createFromScript(silverHalfFlexes);
    Flexagonator.drawUnfolded('silverHalfFlexes', fm, { rotation: 135, content: { showLeafProps: true }, captions: [{ text: "H's", which: 0 }, { text: "H's", which: -1 }] });
  </script>
  <!-- minimal half-flex templates on a silver octaflexagon -->
  <canvas id="silver-half-Hf" width="1000" height="500"></canvas><br/><br/>
  <canvas id="silver-half-Hr" width="1000" height="500"></canvas><br/><br/>
  <canvas id="silver-half-Hfs" width="1000" height="500"></canvas><br/><br/>
  <script type="text/javascript">
    function drawTemplate(canvasId, flexes, rotation, label1, angles) {
      const script = [{ numPats: 8, angles, addHalfFlexes: true }, { flexes, labelAsTree: [] }];
      const fm = Flexagonator.createFromScript(script);
      const text1 = label1 ? flexes : "*"; const scale1 = label1 ? 1 : 2;
      const text2 = label1 ? "*" : flexes; const scale2 = label1 ? 2 : 1;
      const options = {
        rotation, content: { showLeafProps: true },
        captions: [{ text: text1, which: 0, scale: scale1 }, { text: text2, which: -1, scale: scale2 }]
      };
      Flexagonator.drawUnfolded(canvasId, fm, options);
    }
    drawTemplate("silver-half-Hf", "Hf+", 45, false, [45, 90]);   // Hb
    drawTemplate("silver-half-Hr", "Hr+", -45, true, [45, 90]);   // Hl
    drawTemplate("silver-half-Hfs", "Hfs+", -45, true, [45, 90]); // Hbs
  </script>
  <!-- St, Mf, and S3 -->
  <canvas id="half-St" width="700" height="700"></canvas>
  <canvas id="half-Mf" width="1000" height="400"></canvas><br/><br/>
  <canvas id="half-S3" width="1000" height="400"></canvas><br/><br/>
  <script type="text/javascript">
    drawStripSequence("half-St", 8, "St*", 135, [45, 90], ">>>>", 5, 1);
    drawStripSequence("half-Mf", 8, "Mf*", 45, [45, 45], ">>", -2);
    drawStripSequence("half-S3", 8, "S3*", 45, [45, 45], ">>", -2);
  </script>

  <h3 id="slot-flexes">slot flexes</h3>

  <p>supports Lh Lk Ltf Ltb Lbb Lbf</p>
  <canvas id="slot-6-many" width="1000" height="600"></canvas><br/><br/>
  <canvas id="slot-8" width="1000" height="500"></canvas><br/><br/>
  <p>supports L3, Lk, Ltf</p>
  <canvas id="slot-5-L3" width="800" height="500"></canvas><br/><br/>
  <script type="text/javascript">
    drawStripSequence("slot-6-many", 6, "Lk+ Ltb+ Lbb+", 90, [60, 60], ">>>^", -6);
    drawStripSequence("slot-8", 8, "Lk+ Ltf+", 45, [], ">>^", 2);

    // custom labels for the L3 pentaflexagon to make the flex diagram simpler
    const leafProps = pairsToProps([[3, 2], [4, 5], [1, 5], [3, 4], [2, 6], [8, 7], [8, 1], [7, 6], [1, 2], [3, 2], [4, 5], [1, 5], [3, 4], [2, 1]]);
    drawOddStripSequence("slot-5-L3", 5, "L3*", 252, "", 2, "L3", leafProps);
  </script>

  <h3 id="hexa-silver-dodeca">hexagonal silver dodeca</h3>

  <canvas id="hsd-plain" width="500" height="270"></canvas>
  <script type="text/javascript">
    drawFromName('hsd-plain', 'hexagonal silver dodecaflexagon', 90);
  </script>
  <canvas id="silverDodecaHexa1" width="1000" height="500"></canvas><br/><br/>
  <canvas id="silverDodecaHexa2" width="1200" height="200"></canvas><br/><br/>
  <canvas id="silverDodecaHexa3" width="1000" height="400"></canvas><br/><br/>
  <canvas id="silverDodecaHexa4" width="1000" height="400"></canvas><br/><br/>
  <canvas id="silverDodecaHexa5" width="1000" height="400"></canvas><br/><br/>
  <canvas id="silverDodecaHexa6" width="1000" height="600"></canvas><br/><br/>
  <canvas id="silverDodecaHexa7" width="1000" height="400"></canvas><br/><br/>
  <script type="text/javascript">
    var angles = [45, 90];
    var directions = [0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1];
    function drawStripFromFlexes(canvasId, flexes, rotation, text) {
      var halfFlex = {
        "addFlex": {
          "name": "half flex",
          "shorthand": "H",
          "input": [1, 2, [-4, 3], -5, -6, -7, -8, -9, [11, -10], 12, 13, 14],
          "output": [-13, [1, -14], 2, 3, 4, 5, 6, [-8, 7], -9, -10, -11, -12]
        }
      };
      var slideFlex = {
        "addFlex": {
          "name": "double slide",
          "shorthand": "Ds",
          "input": [1, [-3, 2], -4, -5, [7, -6], 8, 9, [-11, 10], -12, -13, [15, -14], 16],
          "output": [-14, -15, [1, -16], 2, 3, [-5, 4], -6, -7, [9, -8], 10, 11, [-13, 12]]
        }
      };
      var tuck12 = {
        "addFlex": {
          "name": "tuck 12",
          "shorthand": "T12",
          "input": [[[-2, 3], 1], 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14],
          "output": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, [2, [14, -1]]]
        }
      };
      var script = [{ numPats: 12, angles, directions }, halfFlex, slideFlex, tuck12, { flexes }];
      var fm = Flexagonator.createFromScript(script);
      Flexagonator.drawUnfolded(canvasId, fm, { rotation, content: { showFoldingOrder: true }, captions: [{ text, which: 0 }, lastStar] });
    }
    drawStripFromFlexes('silverDodecaHexa1', 'H+', 45, 'H');
    drawStripFromFlexes('silverDodecaHexa2', 'H*H*', 90, 'HH');
    drawStripFromFlexes('silverDodecaHexa3', 'Ds+', 0, 'Ds');
    drawStripFromFlexes('silverDodecaHexa4', '<T12+>', 90, '<T12');
    drawStripFromFlexes('silverDodecaHexa5', '>>T12+<<', 180, '>>T12');
    drawStripFromFlexes('silverDodecaHexa6', '<T12+>>>T12+>>>T12+>>>T12+>>>>', 90, "T12's");

    var pats = [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]];
    var fm = Flexagonator.createFromScript([{ pats, angles, directions }]);
    Flexagonator.drawUnfolded('silverDodecaHexa7', fm, { rotation: 0, content: { showFoldingOrder: true }, captions: [{ text: 'double', which: 0 }, lastStar] });
  </script>
  <!-- plain pentagonal silver decaflexagon -->
  <p>pentagonal silver decaflexagon</p>
  <canvas id="psd-plain" width="600" height="350"></canvas>
  <script type="text/javascript">
    drawFromName('psd-plain', 'pentagonal silver decaflexagon', 45);
  </script>
  <!-- various full flexes -->
  <p>Hf'Hb</p>
  <canvas id="psd-HfHb1" width="500" height="500"></canvas>
  <canvas id="psd-HfHb2" width="500" height="500"></canvas>
  <p>Hr'Hl</p>
  <canvas id="psd-HrHl" width="1000" height="350"></canvas>
  <p>Hfs'Hf</p>
  <canvas id="psd-HfsHf" width="1000" height="500"></canvas>
  <script type="text/javascript">
    // pairs that give non-overlapping templates: Hf'Hb, Hf'Hr, Hf'Hl, Hf'Hbs, Hr'Hf, Hr'Hb, Hr'Hl, Hfs'Hb
    function makeScript(one, two) {
      // this is basically one' followed by two, with shifts to get the correct hinge
      var flexes = ">>>>> " + one + "'* " + two + "+ " + one + "<<<<<";
      var script = [
        { "name": "pentagonal silver decaflexagon" },
        { "addHalfFlexes": true },
        { "flexes": flexes }
      ];
      return Flexagonator.createFromScript(script);
    }
    function draw(canvas, one, two, rotation) {
      var fm = makeScript(one, two);
      Flexagonator.drawUnfolded(canvas, fm,
        { rotation, content: { showFoldingOrder: true }, captions: [{ text: one + "'", which: 0 }, { text: two, which: -1 }] });
    }
    function drawHfHb() {
      var fm = makeScript("Hf", "Hb");
      Flexagonator.drawUnfolded("psd-HfHb1", fm,
        { rotation: 0, content: { showFoldingOrder: true }, scale: 245, start: 0, end: 10, captions: [{ text: "Hf'", which: 0 }, { text: "a", which: -1 }] });
      Flexagonator.drawUnfolded("psd-HfHb2", fm,
        { rotation: 0, content: { showFoldingOrder: true }, scale: 245, start: 11, end: 14, captions: [{ text: "a", which: 0 }, { text: "Hb", which: -1 }] });
    }
    drawHfHb();
    draw("psd-HrHl", "Hr", "Hl", 0);
    draw("psd-HfsHf", "Hfs", "Hb", 90);
  </script>

  <hr />

  <!-- part 3 -->

  <h2 id="part3">Part 3: Learning</h2>

  <!-- state-diagrams -->
  <h3 id="state-diagrams">state-diagrams</h3>

  <canvas id="diagram-tuckerman-4" width="139" height="200"></canvas>
  <canvas id="diagram-tuckerman-5" width="200" height="200"></canvas>
  <canvas id="diagram-tuckerman-6a" width="200" height="200"></canvas>
  <canvas id="diagram-tuckerman-6b" width="200" height="200"></canvas>
  <canvas id="diagram-tuckerman-6c" width="265" height="200"></canvas><br/>

  <p>(S&lt;)3</p>
  <canvas id="diagram-s3" width="1000" height="750"></canvas><br/>

  <p>11 leaf hexaflexagon</p>
  <canvas id="diagram-hexa11" width="1000" height="350"></canvas><br/>

  <script type="text/javascript">
    drawTuckerman("diagram-tuckerman-4", "(P*)2");
    drawTuckerman("diagram-tuckerman-5", "(P*)3");
    drawTuckerman("diagram-tuckerman-6a", "P* P* P+ > P P*");
    drawTuckerman("diagram-tuckerman-6b", "(P*^>)4");
    drawTuckerman("diagram-tuckerman-6c", "(P*)4");
    drawStripComplex("diagram-s3",
      [{ pats: [[-2, 1], [-7, [-3, [6, [4, -5]]]], [11, [-8, [-10, 9]]], 12, [[[15, -14], -16], 13], [18, -17]] }, { labelAsTree: [] }],
      { content: { showLeafProps: true, showIds: true }, rotation: 0, captions: starCaptions });
    drawStripComplex("diagram-hexa11",
      [{ pats: [[-2, 1], [[4, -5], -3], [7, -6], 8, [-10, 9], -11] }, { labelAsTree: [] }],
      { content: { showLeafProps: true, showIds: true }, rotation: 120, captions: starCaptions });
  </script>

  <!-- sequences -->
  <h3 id="sequences">sequences</h3>

  <p>(P>)3</p>
  <canvas id="sequences-pinch1" width="200" height="200"></canvas>
  <canvas id="sequences-pinch2" width="200" height="200"></canvas>
  <canvas id="sequences-pinch3" width="200" height="200"></canvas>
  <canvas id="sequences-pinch4" width="200" height="200"></canvas>
  <br/>

  <p>(F&lt;)6</p>
  <canvas id="sequences-flipleft1" width="1200" height="240"></canvas><br/>
  <canvas id="sequences-flipleft2" width="1200" height="240"></canvas><br/>
  <canvas id="sequences-flip1" width="200" height="200"></canvas>
  <canvas id="sequences-flip2" width="200" height="200"></canvas>
  <canvas id="sequences-flip3" width="200" height="200"></canvas>
  <canvas id="sequences-flip4" width="200" height="200"></canvas>
  <br/>
  <canvas id="sequences-flip5" width="200" height="200"></canvas>
  <canvas id="sequences-flip6" width="200" height="200"></canvas>
  <canvas id="sequences-flip7" width="200" height="200"></canvas>
  <br/>

  <p>(S>T'>^T&lt;&lt;^)2</p>
  <canvas id="sequences-s-cycle" width="1200" height="500"></canvas><br/>
  <canvas id="sequences-s1" width="180" height="200"></canvas>
  <canvas id="sequences-s2" width="180" height="200"></canvas>
  <canvas id="sequences-s3" width="180" height="200"></canvas>
  <canvas id="sequences-s4" width="180" height="200"></canvas>
  <br/>
  <canvas id="sequences-s5" width="180" height="200"></canvas>
  <canvas id="sequences-s6" width="180" height="200"></canvas>
  <canvas id="sequences-s7" width="180" height="200"></canvas>
  <br/>

  <p>(Ltb>P>P>) 12</p>
  <canvas id="sequences-hexa12" width="1200" height="170"></canvas><br/>

  <script type="text/javascript">
    drawSequence("sequences-pinch", 6, "P+", ["", "P>", "P>", "P>"]);

    var flipleft = [{ numPats: 8 }, { flexes: "(F*<)6" }, { labelAsTree: true }];
    drawStripComplex("sequences-flipleft1", flipleft,
      { end: 11, content: { showLeafProps: true }, scale: 140, rotation: 67.5, captions: [firstStar, { text: "a", which: -1 }, { text: "(F<)6", which: -3 }] });
    drawStripComplex("sequences-flipleft2", flipleft,
      { start: 12, content: { showLeafProps: true }, scale: 140, rotation: 180 + 67.5, captions: [lastStar, { text: "a", which: 0 }] });
    drawSequence("sequences-flip", 8, "(F*<)6", ["", "F<", "F<", "F<", "F<", "F<", "F<"], 1.1, -22.5);

    drawStripComplex("sequences-s-cycle", [{ numPats: 6 }, { flexes: "S+", labelAsTree: true }],
      { rotation: 120, content: { showLeafProps: true }, captions: [{ text: "S", which: 0 }, { text: "S", which: -1 }] });
    drawSequence("sequences-s", 6, "S+", ["", "S>", "T'>^", "T<<^", "S>", "T'>^", "T<<^"], 1.1, -30);

    drawStripComplex("sequences-hexa12",
      [{ pats: [[0, 0], 0, [0, 0], 0, [0, 0], [[0, 0], [0, 0]]] }, { labelAsTree: true }],
      { content: { showLeafProps: true }, captions: [{ text: "12", which: 0 }, { text: "12", which: -1 }] });
  </script>

  <!-- pat-notation -->
  <h3 id="pat-notation">pat notation</h3>

  <p>example</p>
  <canvas id="pats-example-unfolded" width="1000" height="600"></canvas><br/>
  <canvas id="pats-example-folded" width="500" height="500"></canvas><br/>
  <p>tri-hexa</p>
  <canvas id="pats-trihexa-unfolded" width="1000" height="180"></canvas><br/>
  <canvas id="pats-trihexa-folded1" width="500" height="500"></canvas>
  <canvas id="pats-trihexa-folded2" width="500" height="500"></canvas>
  <p>same visible leaves, different structure</p>
  <canvas id="pats-visible-Tf" width="1100" height="480"></canvas><br/>
  <canvas id="pats-visible-T" width="1200" height="500"></canvas>
  <script type="text/javascript">
    // example
    var example = [
      { pats: [1, [-3, 2], [-6, [-4, 5]], [[8, -9], -7], -10, [[[-13, 12], 14], -11]] },
      { labelAsTree: [], searchFlexes: "P S T V" }
    ];
    var fm1 = Flexagonator.createFromScript(example);
    Flexagonator.drawUnfolded("pats-example-unfolded", fm1, { content: { showLeafProps: true, showIds: true }, rotation: 180, captions: starCaptions });
    var regions = Flexagonator.drawEntireFlexagon("pats-example-folded", fm1, { showCurrent: false });
    Flexagonator.drawScriptButtons("pats-example-folded", fm1.flexagon, fm1.getAngleInfo(), true, regions);
    // tri-hexa
    var trihexa = [
      { pats: [[-2, 1], -3, [5, -4], 6, [-8, 7], -9] },
      { labelAsTree: [] }
    ];
    var fm2 = Flexagonator.createFromScript(trihexa);
    Flexagonator.drawUnfolded("pats-trihexa-unfolded", fm2, { content: { showLeafProps: true, showIds: true }, rotation: 60, captions: starCaptions });
    Flexagonator.drawEntireFlexagon("pats-trihexa-folded1", fm2, {});
    var fm3 = Flexagonator.runScript(fm2, [{ flexes: "P" }]);
    Flexagonator.drawEntireFlexagon("pats-trihexa-folded2", fm3, {});
    // visible
    drawStripComplex("pats-visible-Tf",
      [{ "pats": [[[-2, [[-4, [7, [5, -6]]], 3]], 1], 8, 9, 10, 11, 12] }],
      { rotation: 60, content: { showFoldingOrder: true, showIds: true }, captions: starCaptions });
    drawStripComplex("pats-visible-T",
      [{ "pats": [[[-2, [[-4, [7, [5, -6]]], 3]], 1], 8, [-10, 9], [12, -11], [-14, 13], -15] }],
      { rotation: 90, content: { showFoldingOrder: true, showIds: true }, captions: starCaptions });
  </script>

  <!-- atomic flex theory -->
  <h3 id="atomic-flex-theory">atomic flex theory</h3>

  <p>isoflexagons</p>
  <canvas id="atomic-iso1" width="230" height="250"></canvas>&nbsp;&nbsp;&nbsp;&nbsp;
  <canvas id="atomic-iso2" width="250" height="250"></canvas>
  <canvas id="atomic-iso3" width="250" height="250"></canvas>
  <canvas id="atomic-iso4" width="230" height="250"></canvas>
  <canvas id="atomic-iso5" width="240" height="250"></canvas><br/>
  <p>non-isoflexagons</p>
  <canvas id="atomic-non-iso1" width="250" height="250"></canvas>&nbsp;&nbsp;&nbsp;
  <canvas id="atomic-non-iso2" width="310" height="250"></canvas>&nbsp;&nbsp;
  <canvas id="atomic-non-iso3" width="200" height="250"></canvas>&nbsp;&nbsp;
  <canvas id="atomic-non-iso4" width="230" height="250"></canvas>&nbsp;&nbsp;
  <canvas id="atomic-non-iso5" width="200" height="250"></canvas><br/>
  <p>pentagonal silver decaflexagon</p>
  <img src="images/pentagonal-silver-deca-directions.png"/>
  <p>pyramid shuffle with directions</p>
  <canvas id="atomic-shuffle-directions" width="1000" height="650"></canvas><br/>
  <img src="images/shuffle-directions.png"/>
  <script>
    drawFromName("atomic-iso1", "pentaflexagon", 18);
    drawFromName("atomic-iso2", "hexaflexagon", 0);
    drawFromName("atomic-iso3", "bronze hexaflexagon", 30);
    drawFromName("atomic-iso4", "heptaflexagon", -12.5);
    drawFromName("atomic-iso5", "right decaflexagon", -18);
    drawFromName("atomic-non-iso1", "pentagonal silver decaflexagon", 45);
    drawFromName("atomic-non-iso2", "hexagonal silver dodecaflexagon", 90);
    drawFromName("atomic-non-iso3", "octagonal ring dodecaflexagon", 0);
    drawFromName("atomic-non-iso4", "hexagonal ring dodecaflexagon", 0);
    drawFromName("atomic-non-iso5", "octagonal ring tetradecaflexagon", 0);
    const theScript = [{ pats: [[-2, 1], -3, -4, -5, [[[-8, 7], 9], -6], 10] }];
    const theOptions = { rotation: 120, content: { showIds: true }, captions: starCaptions };
    drawStripComplex("atomic-shuffle-directions", theScript, theOptions);
  </script>

  <!-- groups-->
  <h3 id="groups">groups</h3>

  <canvas id="group-tetra-strip" width="1200" height="220"></canvas><br/>
  <canvas id="group-tetra1" width="250" height="250"></canvas>
  <canvas id="group-tetra2" width="250" height="250"></canvas>
  <script type="text/javascript">
    drawStripPinch("group-tetra-strip", 6, "(P*)2", 90);
    var script = [{ numPats: 6 }, { angles: [60, 60] }, { flexes: "(P*)2" }, { searchFlexes: "P" }];
    // face only supports P at 3 hinges
    drawFlexagonComplex("group-tetra1", script);
    // face supports P at all 6 hinges
    drawFlexagonComplex("group-tetra2", script.concat({ flexes: ">P<P" }));
  </script>

  <!-- part 4 -->

  <h2 id="part4">Part 4: Fun</h2>

  <h3 id="popups">popups</h3>

  <p>right triangle tetraflexagon</p>
  <canvas id="right-tetra4a" width="400" height="250"></canvas>
  <canvas id="right-tetra4b" width="300" height="250"></canvas>
  <script type="text/javascript">
    var script = [{ numPats: 4, flexAndColor: { flexes: "P*(^>P*)2" } }];
    drawStripComplex("right-tetra4a", script,
      { rotation: -45, content: { showFoldingOrder: true }, start: 0, end: 7, captions: [firstStar, { text: "a", which: -1 }] });
    drawStripComplex("right-tetra4b", script,
      { rotation: -45, content: { showFoldingOrder: true }, start: 8, end: 9, captions: [{ text: "a", which: 0 }, lastStar] });
  </script>

  <p>regular tetraflexagons</p>
  <canvas id="equi-tetra3" width="800" height="250"></canvas><br/>
  <canvas id="equi-tetra5" width="800" height="600"></canvas>
  <script type="text/javascript">
    var script = [{ numPats: 4, flexes: "P*", angles: [60, 60], labelAsTree: [] }];
    var drawOptions = { rotation: 120, content: { showLeafProps: true }, captions: starCaptions };
    drawStripComplex("equi-tetra3", script, drawOptions);
  </script>
  <script type="text/javascript">
    var script = [{ numPats: 4, flexes: "(P*)3 P'P'", angles: [60, 60], labelAsTree: [] }];
    var drawOptions = { rotation: 60, content: { showLeafProps: true }, captions: starCaptions };
    drawStripComplex("equi-tetra5", script, drawOptions);
  </script>

  <p>animal pentaflexagon</p>
  <canvas id="animal-penta" width="800" height="700"></canvas>
  <script type="text/javascript">
    var script = [{ "pats": [0, [[[0, 0], 0], 0], 0, [[[0, 0], 0], 0], 0] }, { "angles": [72, 54] }];
    var options = { rotation: 72, content: { showFoldingOrder: true }, captions: starCaptions };
    drawStripComplex("animal-penta", script, options);
  </script>

</body>

</html>
